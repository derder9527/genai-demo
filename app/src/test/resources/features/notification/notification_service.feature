# language: zh-TW
功能: 通知服務
  作為一個訂單系統
  我需要向客戶發送各種通知
  以便客戶了解訂單的最新狀態

  背景:
    假設通知系統正常運行
    並且客戶已設置接收通知

  場景: 發送訂單創建通知
    當客戶創建新訂單
    並且訂單ID為 "ORD-20240510-001"
    那麼系統應該發送訂單創建通知
    並且通知應該包含訂單ID "ORD-20240510-001"
    並且通知應該包含訂單創建時間
    並且通知應該發送到客戶的郵箱和手機

  場景: 發送訂單確認通知
    當訂單支付成功
    並且訂單狀態更新為 "已確認"
    那麼系統應該發送訂單確認通知
    並且通知應該包含訂單詳情
    並且通知應該包含預計配送時間

  場景: 發送支付失敗通知
    當訂單支付失敗
    並且失敗原因為 "信用卡餘額不足"
    那麼系統應該發送支付失敗通知
    並且通知應該包含失敗原因
    並且通知應該包含重新支付的鏈接

  場景: 發送庫存不足通知
    當訂單中的商品庫存不足
    並且無法完成訂單
    那麼系統應該發送庫存不足通知
    並且通知應該包含庫存不足的商品信息
    並且通知應該包含替代商品建議

  場景: 發送配送狀態更新通知
    當配送狀態更新為 "配送中"
    並且有預計送達時間
    那麼系統應該發送配送狀態更新通知
    並且通知應該包含當前配送狀態
    並且通知應該包含預計送達時間
    並且通知應該包含配送追蹤鏈接

  場景: 發送訂單完成通知
    當客戶確認收貨
    並且訂單狀態更新為 "已完成"
    那麼系統應該發送訂單完成通知
    並且通知應該包含訂單評價鏈接
    並且通知應該包含相關商品推薦

  場景: 通知發送失敗處理
    假設客戶的郵箱地址無效
    當系統嘗試發送通知到客戶郵箱
    並且發送失敗
    那麼系統應該記錄發送失敗事件
    並且系統應該嘗試通過其他渠道發送通知
    並且系統應該在 24 小時內重試發送

  場景: 客戶設置通知偏好
    當客戶更新通知偏好設置
    並且選擇只接收 "訂單狀態變更" 和 "配送狀態" 通知
    並且選擇通過 "短信" 接收通知
    那麼系統應該更新客戶的通知偏好
    並且客戶應該只收到所選類型的通知
    並且通知應該只通過短信發送