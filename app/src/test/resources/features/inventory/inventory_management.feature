# language: zh-TW
功能: 庫存管理
  作為一個訂單系統
  我需要檢查和管理商品庫存
  以確保訂單中的商品有足夠庫存可供配送

  背景:
    假設系統中有商品目錄
    並且庫存系統正常運行

  場景: 成功檢查庫存充足
    假設商品 "iPhone 15" 的庫存數量為 10
    當訂單包含商品 "iPhone 15" 數量為 2
    並且系統檢查庫存
    那麼庫存檢查結果應該為 "充足"
    並且系統應該預留 2 個 "iPhone 15" 的庫存
    並且可用庫存數量應該更新為 8

  場景: 庫存不足
    假設商品 "限量版手機" 的庫存數量為 1
    當訂單包含商品 "限量版手機" 數量為 2
    並且系統檢查庫存
    那麼庫存檢查結果應該為 "不足"
    並且系統不應該預留任何庫存
    並且系統應該通知訂單系統庫存不足

  場景: 多種商品庫存檢查
    假設商品 "iPhone 15" 的庫存數量為 5
    並且商品 "AirPods Pro" 的庫存數量為 10
    當訂單包含以下商品:
      | 商品名稱      | 數量 |
      | iPhone 15     | 2    |
      | AirPods Pro   | 3    |
    並且系統檢查庫存
    那麼庫存檢查結果應該為 "充足"
    並且系統應該預留所有訂單商品的庫存
    並且 "iPhone 15" 的可用庫存數量應該更新為 3
    並且 "AirPods Pro" 的可用庫存數量應該更新為 7

  場景: 庫存預留超時
    假設商品 "iPhone 15" 的庫存數量為 5
    並且系統已為訂單預留 2 個 "iPhone 15"
    當預留時間超過 30 分鐘
    並且訂單仍未支付
    那麼系統應該釋放預留的庫存
    並且 "iPhone 15" 的可用庫存數量應該更新為 5

  場景: 訂單取消後釋放庫存
    假設商品 "iPhone 15" 的庫存數量為 10
    並且系統已為訂單預留 2 個 "iPhone 15"
    並且可用庫存數量為 8
    當訂單被取消
    那麼系統應該釋放預留的庫存
    並且 "iPhone 15" 的可用庫存數量應該更新為 10

  場景: 庫存閾值警告
    假設商品 "iPhone 15" 的庫存閾值設置為 5
    當商品 "iPhone 15" 的庫存數量降至 5 以下
    那麼系統應該生成庫存警告
    並且庫存管理員應該收到補貨通知

  場景: 庫存同步
    假設外部倉庫系統更新了商品庫存
    當庫存同步任務執行
    那麼系統應該從外部倉庫系統獲取最新庫存數據
    並且系統應該更新本地庫存記錄
    並且庫存歷史記錄應該包含同步事件